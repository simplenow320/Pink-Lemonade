{% extends "base.html" %}

{% block title %}{{ grant.title }} - Pink Lemonade{% endblock %}

{% block extra_css %}
<style>
  .detail-card {
    background: white;
    border-radius: 16px;
    padding: 32px;
    border: 1px solid #E8E8E8;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    margin-bottom: 24px;
  }
  
  .fit-badge {
    background: linear-gradient(135deg, #B8899A, #D4BAC7);
    color: white;
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 0.9rem;
    font-weight: 600;
    display: inline-block;
  }
  
  .btn-primary {
    background: #B8899A;
    color: white;
    padding: 12px 24px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    font-size: 1rem;
    font-weight: 500;
    transition: all 0.2s ease;
    text-decoration: none;
    display: inline-block;
  }
  
  .btn-primary:hover {
    background: #A67A8A;
    color: white;
    text-decoration: none;
  }
  
  .btn-outline {
    background: white;
    color: #B8899A;
    padding: 12px 24px;
    border: 1px solid #B8899A;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1rem;
    font-weight: 500;
    transition: all 0.2s ease;
    text-decoration: none;
    display: inline-block;
  }
  
  .btn-outline:hover {
    background: #B8899A;
    color: white;
    text-decoration: none;
  }
  
  .info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 24px;
    margin: 24px 0;
  }
  
  .info-item {
    padding: 16px;
    background: #F8F9FA;
    border-radius: 8px;
  }
  
  .info-label {
    color: #6B6B6B;
    font-size: 0.9rem;
    margin-bottom: 4px;
  }
  
  .info-value {
    color: #2A2A2A;
    font-weight: 500;
    font-size: 1.1rem;
  }
</style>
{% endblock %}

{% block content %}
<div style="max-width: 800px; margin: 0 auto; padding: 20px;">
  <!-- Back Button -->
  <div style="margin-bottom: 20px;">
    <a href="/opportunities" class="btn-outline">← Back to Opportunities</a>
  </div>
  
  <!-- Grant Header -->
  <div class="detail-card">
    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 16px;">
      <div style="flex: 1;">
        <h1 style="font-size: 2rem; font-weight: 700; color: #2A2A2A; margin: 0 0 8px 0; line-height: 1.2;">
          {{ grant.title }}
        </h1>
        <p style="font-size: 1.2rem; color: #6B6B6B; margin: 0; font-weight: 500;">{{ grant.funder }}</p>
      </div>
      {% if grant.match_score %}
      <div class="fit-badge">
        {{ grant.match_score }}/5 ★
      </div>
      {% endif %}
    </div>
    
    <!-- Grant Info Grid -->
    <div class="info-grid">
      <div class="info-item">
        <div class="info-label">Funding Amount</div>
        <div class="info-value">
          {% if grant.amount_min and grant.amount_max %}
            ${{ "{:,}".format(grant.amount_min|int) }} - ${{ "{:,}".format(grant.amount_max|int) }}
          {% elif grant.amount_min %}
            ${{ "{:,}".format(grant.amount_min|int) }}+
          {% elif grant.amount_max %}
            Up to ${{ "{:,}".format(grant.amount_max|int) }}
          {% else %}
            Not specified
          {% endif %}
        </div>
      </div>
      
      <div class="info-item">
        <div class="info-label">Application Deadline</div>
        <div class="info-value">
          {% if grant.deadline %}
            {{ grant.deadline.strftime('%B %d, %Y') }}
          {% else %}
            Rolling deadline
          {% endif %}
        </div>
      </div>
      
      {% if grant.geography %}
      <div class="info-item">
        <div class="info-label">Location</div>
        <div class="info-value">{{ grant.geography }}</div>
      </div>
      {% endif %}
      
      {% if grant.source_name %}
      <div class="info-item">
        <div class="info-label">Source</div>
        <div class="info-value">{{ grant.source_name }}</div>
      </div>
      {% endif %}
    </div>
    
    <!-- Action Buttons -->
    <div style="display: flex; gap: 16px; margin-top: 24px;">
      <button onclick="saveGrant({{ grant.id }})" class="btn-outline">Save Grant</button>
      {% if grant.link %}
      <a href="{{ grant.link }}" target="_blank" class="btn-primary">View Application Details</a>
      {% else %}
      <button onclick="createApplication({{ grant.id }})" class="btn-primary">Start Application</button>
      {% endif %}
    </div>
  </div>
  
  <!-- Grant Description/Eligibility -->
  {% if grant.eligibility %}
  <div class="detail-card">
    <h2 style="font-size: 1.4rem; font-weight: 600; color: #2A2A2A; margin: 0 0 16px 0;">Eligibility & Description</h2>
    <div style="color: #4A4A4A; line-height: 1.6;">
      {{ grant.eligibility|safe }}
    </div>
  </div>
  {% endif %}
  
  <!-- Match Reasoning -->
  {% if grant.match_reason %}
  <div class="detail-card">
    <h2 style="font-size: 1.4rem; font-weight: 600; color: #2A2A2A; margin: 0 0 16px 0;">Why This Grant Fits Your Organization</h2>
    <div style="color: #4A4A4A; line-height: 1.6;">
      {{ grant.match_reason }}
    </div>
  </div>
  {% endif %}
  
  <!-- Grant Status -->
  <div class="detail-card">
    <h2 style="font-size: 1.4rem; font-weight: 600; color: #2A2A2A; margin: 0 0 16px 0;">Application Status</h2>
    <div style="display: flex; align-items: center; gap: 8px;">
      <span style="padding: 6px 12px; background: #E3F2FD; color: #1976D2; border-radius: 16px; font-size: 0.9rem; text-transform: capitalize;">
        {{ grant.status }}
      </span>
      {% if grant.created_at %}
      <span style="color: #6B6B6B; font-size: 0.9rem;">
        Added {{ grant.created_at.strftime('%B %d, %Y') }}
      </span>
      {% endif %}
    </div>
  </div>
</div>

<!-- Toast notification -->
<div id="toast" style="position:fixed;bottom:20px;left:50%;transform:translateX(-50%);background:#B8899A;color:white;padding:12px 20px;border-radius:8px;display:none;z-index:1000">
  <span id="toastMessage"></span>
</div>

<script>
function saveGrant(grantId) {
  // Add save functionality here
  showToast('Grant saved successfully!');
}

function createApplication(grantId) {
  // Add application creation functionality here
  showToast('Application creation coming soon!');
}

function showToast(message) {
  const toast = document.getElementById('toast');
  const toastMessage = document.getElementById('toastMessage');
  toastMessage.textContent = message;
  toast.style.display = 'block';
  setTimeout(() => {
    toast.style.display = 'none';
  }, 3000);
}
</script>
{% endblock %}
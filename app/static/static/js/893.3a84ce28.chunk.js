"use strict";(self.webpackChunkgrantflow_client=self.webpackChunkgrantflow_client||[]).push([[893],{9893:(e,s,t)=>{t.r(s),t.d(s,{default:()=>o});var a=t(7405),r=t(5563),i=t(9033),n=t(5380),l=t(6779);const o=()=>{const{projectId:e}=(0,i.g)(),[s]=(0,i.ok)(),t=s.get("role")||"participant",[o,c]=(0,r.useState)(null),[d,u]=(0,r.useState)({}),[m,x]=(0,r.useState)(0),[h,p]=(0,r.useState)(!0),[g,y]=(0,r.useState)(!1),[b,j]=(0,r.useState)(!1);(0,r.useEffect)(()=>{f()},[e,t]);const f=async()=>{try{const s=await fetch("/api/smart-reporting/phase3/survey/".concat(e,"?role=").concat(t)),a=await s.json();a.success?c(a.survey):console.error("Failed to load survey:",a.error)}catch(s){console.error("Survey loading error:",s)}finally{p(!1)}},v=(e,s)=>{u(t=>(0,a.A)((0,a.A)({},t),{},{[e]:s}))};if(h)return(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Loading survey..."})]})});if(b)return(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:(0,l.jsxs)(n.P.div,{className:"max-w-md mx-auto bg-white rounded-lg shadow-lg p-8 text-center",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},children:[(0,l.jsx)("div",{className:"text-6xl mb-4",children:"\ud83c\udf89"}),(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Thank You!"}),(0,l.jsx)("p",{className:"text-gray-600 mb-6",children:"Your survey response has been submitted successfully. Your input is valuable for measuring program impact."}),(0,l.jsx)("div",{className:"bg-pink-50 border border-pink-200 rounded-lg p-4",children:(0,l.jsx)("p",{className:"text-pink-800 text-sm",children:"You can close this window. If you have questions, contact us at support@pinklemonade.app"})})]})});if(!o||!o.questions||0===o.questions.length)return(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:(0,l.jsxs)("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-lg p-8 text-center",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Survey Not Available"}),(0,l.jsx)("p",{className:"text-gray-600 mb-6",children:"The survey you're looking for is not available or has been completed."})]})});const N=(m+1)/o.questions.length*100,w=o.questions[m];return(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 py-8 px-4",children:(0,l.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,l.jsxs)("div",{className:"text-center mb-8",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"\ud83c\udf4b Impact Survey"}),(0,l.jsxs)("p",{className:"text-gray-600",children:["Project: ",o.project_name," | Role: ",t]})]}),(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[(0,l.jsxs)("span",{children:["Question ",m+1," of ",o.questions.length]}),(0,l.jsxs)("span",{children:[Math.round(N),"% Complete"]})]}),(0,l.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,l.jsx)(n.P.div,{className:"bg-pink-500 h-2 rounded-full",initial:{width:0},animate:{width:"".concat(N,"%")},transition:{duration:.5}})})]}),(0,l.jsxs)(n.P.div,{className:"bg-white rounded-lg shadow-lg p-8 mb-8",initial:{x:50,opacity:0},animate:{x:0,opacity:1},transition:{duration:.3},children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:w.question_text}),"scale"===w.question_type&&(0,l.jsx)("div",{className:"space-y-3",children:[1,2,3,4,5].map(e=>(0,l.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,l.jsx)("input",{type:"radio",name:"question_".concat(w.id),value:e,checked:d[w.id]===e,onChange:()=>v(w.id,e),className:"mr-3 text-pink-500"}),(0,l.jsxs)("span",{className:"text-gray-700",children:[e," - ",1===e?"Strongly Disagree":2===e?"Disagree":3===e?"Neutral":4===e?"Agree":"Strongly Agree"]})]},e))}),"text"===w.question_type&&(0,l.jsx)("textarea",{className:"w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent",rows:"4",placeholder:"Please share your thoughts...",value:d[w.id]||"",onChange:e=>v(w.id,e.target.value)}),"multiple_choice"===w.question_type&&w.options&&(0,l.jsx)("div",{className:"space-y-3",children:w.options.map((e,s)=>(0,l.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,l.jsx)("input",{type:"radio",name:"question_".concat(w.id),value:e,checked:d[w.id]===e,onChange:()=>v(w.id,e),className:"mr-3 text-pink-500"}),(0,l.jsx)("span",{className:"text-gray-700",children:e})]},s))})]},m),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("button",{onClick:()=>x(Math.max(0,m-1)),disabled:0===m,className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-medium disabled:opacity-50 hover:bg-gray-300 transition-colors",children:"Previous"}),m<o.questions.length-1?(0,l.jsx)("button",{onClick:()=>x(m+1),disabled:!d[w.id],className:"px-6 py-3 bg-pink-500 text-white rounded-lg font-medium disabled:opacity-50 hover:bg-pink-600 transition-colors",children:"Next"}):(0,l.jsx)("button",{onClick:async()=>{y(!0);try{const s=await fetch("/api/smart-reporting/phase3/survey-response",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({project_id:parseInt(e),respondent_role:t,responses:d})}),a=await s.json();a.success?j(!0):alert("Failed to submit survey: "+a.error)}catch(s){console.error("Survey submission error:",s),alert("Failed to submit survey. Please try again.")}finally{y(!1)}},disabled:!d[w.id]||g,className:"px-6 py-3 bg-green-500 text-white rounded-lg font-medium disabled:opacity-50 hover:bg-green-600 transition-colors",children:g?"Submitting...":"Submit Survey"})]})]})})}}}]);
//# sourceMappingURL=893.3a84ce28.chunk.js.map